@page
@model IndexModel
@{
    ViewData["Title"] = "Home";
}

<div class="container">
    <div class="row">
        <!-- Main content area -->
        <div class="col-md-8">
            <h1>Recent Posts</h1>
            @foreach (var post in Model.Posts)
            {
                <div class="card mb-3">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-2">
                            <!-- Replace with actual subreddit icon URL -->
                            <img src="/images/subreddit-icon.png" class="rounded-circle me-2" width="30" height="30">
                            <a href="/r/@Model.Subreddits.FirstOrDefault(s => s.Id == post.SubredditId)?.Name" class="text-decoration-none text-muted">@Model.Subreddits.FirstOrDefault(s => s.Id == post.SubredditId)?.Name</a>
                            <span class="text-muted ms-auto" data-date="@post.DateCreated.ToString("o")">Posted by <a asp-page="/User" asp-route-username="@Model.Users.FirstOrDefault(u => u.Id == post.UserId)?.Username">u/@Model.Users.FirstOrDefault(u => u.Id == post.UserId)?.Username</a></span>
                        </div>
                        <h5 class="card-title">@post.Title</h5>
                        <p class="card-text">@post.Content</p>
                        <!-- Replace with actual comment count and post ID -->
                        <div class="d-flex align-items-center">
                            <a href="/comments/123" class="text-decoration-none text-muted me-3">123 comments</a>
                            <button type="button" class="btn btn-outline-secondary btn-sm me-2">Share</button>
                            <button type="button" class="btn btn-outline-secondary btn-sm">Save</button>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
<script>
    var dates = document.querySelectorAll('[data-date]');

    dates.forEach(function (date) {
        var isoDate = date.getAttribute('data-date');
        var relativeTime = moment(isoDate).fromNow();
        date.textContent += ' ' + relativeTime;
    });
</script>